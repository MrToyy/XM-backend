<!doctype html>
<head>
  <meta charset="utf-8">

  <title>XiaoMorgan Class</title>
  
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.8.min.js"></script>
  <!--<script type="text/javascript" src="main.js"></script>-->
  <script type="text/javascript">

  function add(accList){
	var promises=[];
	
	var List=Parse.Object.extend("List");
	var list=new Parse.Query(List);
	promises.push(
		list.get("g8FJgQdEkv").then(function(list){
			return list.fetch()
		})
	);
	
	promises.push(accList.fetch());
	
	Parse.Promise.when(promises).then(function(list, accList){
		var acc="acc"+accList.get("accountRef");
		document.getElementById("demo").innerHTML+=acc+"<br>";
		var ca=Number(acc.substr(3,1));
		if (ca==1){
			list.addUnique("assets",acc);
			list.addUnique("BS",acc);
		}
		if (ca==2){
			list.addUnique("liabilities",acc);
			list.addUnique("BS",acc);
		}
		if (ca==3){
			list.addUnique("reserves",acc);
			list.addUnique("BS",acc);
		}
		if (ca==4){
			list.addUnique("income",acc);
			list.addUnique("PL",acc);
		}
		if (ca==5){
			list.addUnique("expense",acc);
			list.addUnique("PL",acc);
		}
		return Parse.Promise.as(list);
	}).then(function(list){
		document.getElementById("demo").innerHTML+="saving "+acc+"<br>";
		list.save();
	});

  }
  
  </script>
  
</head>

<body>
  <p id="demo"></p>
  
  
  <script type="text/javascript">
    Parse.initialize("SPiIOPirSjUFKCT9qDqYfYy1KqTR8l1nokw1mScS", "ZJG4G8WJy7ZktSYKz5iRtCEsTTIoVkK2EabYI0j4");
		var List=Parse.Object.extend("List");
		var list=new List();
		var qList=new Parse.Query(List);
		qList.get("HTmdZZX20E").then(function(list){
			var BS=list.get("BS");
			//document.getElementById("demo").innerHTML+="type of BS is : "+typeof(BS);
			for (i in BS) document.getElementById("demo").innerHTML+=typeof(BS[i])+" : "+BS[i]+"<br>";
		});
  function categorize(accList){
	  return accList.fetch().then(function(accList){
		var acc="acc"+accList.get("accountRef");
		var ca=Number(acc.substr(3,1));
		var pro=[];
		if (ca==1){
			list.addUnique("assets",acc);
			list.addUnique("BS",acc);
		}
		if (ca==2){
			list.addUnique("liabilities",acc);
			list.addUnique("BS",acc);
		}
		if (ca==3){
			list.addUnique("reserves",acc);
			list.addUnique("BS",acc);
		}
		if (ca==4){
			list.addUnique("income",acc);
			list.addUnique("PL",acc);
		}
		if (ca==5){
			list.addUnique("expense",acc);
			list.addUnique("PL",acc);
		}
		//document.getElementById("demo").innerHTML+=BS+"<br>"
		return Parse.Promise.as("done");
	  });
  }
		
	/*var AccountList=Parse.Object.extend("AccountList");
	var qList= new Parse.Query(AccountList);
	qList.find().then(function(qList){
		for(i in qList){
			categorize(qList[i]);
		}
	});*/
	
	function saveList(){

		/*for (i in asserts) list.addUnique("assets",assets[i]);
		for (i in liabilities) list.addUnique("liabilities",liabilities[i]);
		for (i in reserves) list.addUnique("reserves",reserves[i]);
		for (i in BS) list.addUnique("BS",BS[i]);
		for (i in income) list.addUnique("income",income[i]);
		for (i in expense) list.addUnique("expense",expense[i]);
		for (i in PL) list.addUnique("PL",PL[i]);*/
		list.save().then(function(list){
			document.getElementById("demo").innerHTML+="!!!!!"+list.get("BS")+"<br>";
			
		});
	}
	
  </script>
  <button onClick="saveList()">save list</button>
</body>

</html>
